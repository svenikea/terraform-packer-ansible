{
        "agent" :{
                "metrics_collection_interval": 1,
                "logfile": "/opt/aws/amazon-cloudwatch-agent/logs/amazon-cloudwatch-agent.log"
        },
        "metrics": {
                {% if inventory_hostname in groups['bastion_role'] %}
                "namespace" : "Bastion",
                {% elif inventory_hostname in groups['app_role'] %}
                "namespace" : "App",
                {% endif %}
                "metrics_collected": {
                        "mem": {
                                "metrics_collection_interval": 1,
                                "measurement": [
                                        "mem_used_percent",
                                         "mem_available",
                                         "mem_available_percent",
                                         "mem_free",
                                         "mem_total",
                                         "mem_used"
                                ]
                        },
                        "disk": {
                                "metrics_collection_interval": 1,
                                "resources": [
                                        "*"
                                ],
                                "measurement": [
                                        "total",
                                        "used"
                                ],
                                "ignore_file_system_types": [
                                        "sysfs", 
                                        "devtmpfs",
                                        "squashfs",
                                        "tmpfs",
                                        "overlay",
                                        "nfs4"
                                ]
                        },
                        "cpu": {
                                "metrics_collection_interval": 1,
                                "measurement": [
                                        "cpu_usage_system",
                                        "cpu_usage_user",
                                        "cpu_usage_idle",
                                        "cpu_usage_iowait"
                                ]
                        },
                        "net": {
                                "metrics_collection_interval": 1,
                                "resources": [
                                        "eth0"
                                ],
                                "measurement": [
                                        "bytes_sent",
                                        "bytes_recv"
                                ]
                        }
                },
                "append_dimensions": {
                        "ImageId": "${aws:ImageId}",
                        "InstanceId": "${aws:InstanceId}",
                        "InstanceType": "${aws:InstanceType}",
                        "AutoScalingGroupName": "${aws:AutoScalingGroupName}"
                }
        }
}
